From 09398e8b8199069b086083e261acb63b1f854406 Mon Sep 17 00:00:00 2001
From: Pavithra R <pavir@codeaurora.org>
Date: Tue, 20 Aug 2019 09:57:42 -0700
Subject: [PATCH] [tcrypt] AHASH  - Update test vetors for HMAC SHA224

NSS crypto does not support authentication key size greater than hash
algorithm block size in case of HMAC mode. So, the test vectors with
authentication key size greater than block size are under an if check.

Change-Id: I80fc6c08a5228807d79d1c6ccf6c74b803729f78
Signed-off-by: Pavithra R <pavir@codeaurora.org>
---
 crypto/Kconfig   | 6 ++++++
 crypto/testmgr.h | 5 ++++-
 2 files changed, 10 insertions(+), 1 deletion(-)

--- a/crypto/Kconfig
+++ b/crypto/Kconfig
@@ -225,6 +225,12 @@ config CRYPTO_DISABLE_HW_UNSUPPORTED_TES
 	help
 	  Disable hw unsupported test cases
 
+config CRYPTO_DISABLE_AHASH_LARGE_KEY_TEST
+	bool "Disable AHASH test cases with auth key greater than block size"
+	default y
+	help
+	  Disable large key ahash tests
+
 config CRYPTO_SIMD
 	tristate
 	select CRYPTO_CRYPTD
--- a/crypto/testmgr.h
+++ b/crypto/testmgr.h
@@ -5802,7 +5802,9 @@ static const struct hash_testvec hmac_sh
 			"\x45\x69\x0f\x3a\x7e\x9e\x6d\x0f"
 			"\x8b\xbe\xa2\xa3\x9e\x61\x48\x00"
 			"\x8f\xd0\x5e\x44",
-	}, {
+	},
+#ifndef CONFIG_CRYPTO_DISABLE_AHASH_LARGE_KEY_TEST
+	{
 		.key    = "\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
 			"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
 			"\xaa\xaa\xaa\xaa\xaa\xaa\xaa\xaa"
@@ -5881,6 +5883,7 @@ static const struct hash_testvec hmac_sh
 			"\x94\x67\x70\xdb\x9c\x2b\x95\xc9"
 			"\xf6\xf5\x65\xd1",
 	},
+#endif
 };
 
 /*
